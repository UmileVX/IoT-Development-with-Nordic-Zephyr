#include <zephyr/drivers/led.h>
#include <zephyr/drivers/kscan.h>
#include <zephyr/devicetree.h>
#include <zephyr/kernel.h>

#define LED_NODE DT_COMPAT_GET_ANY_STATUS_OKAY(holtek_ht16k33)
#define KEY_NODE DT_CHILD(LED_NODE, keyscan)

#define LED_NUM 128
#define MAX_ROTARY_IDX 15

static const struct device *const led = DEVICE_DT_GET(LED_NODE);

int led_init(void);

void led_off_all(void);
void led_on_idx(int idx);

// [0]
// * * * * * * * * * * * * * * * *  0 ~ 15
// * * * * * * * * * * * * * * * * 16 ~ 31
// * * * * * * * * * * * * * * * * 32 ~ 47
// x x x x x x x x * * * * * * * * 48 ~ 63 (48 ~ 55)
// * * * * * * * * x x x x x x x x 64 ~ 79 (72 ~ 79)
// * * * * * * * * * * * * * * * * 80 ~ 95
// * * * * * * * * * * * * * * * * 96 ~ 111
// * * * * * * * * * * * * * * * * 112 ~ 127

// [1]
// * * * * * * * * * * * * * * * *  0 ~ 15
// * * * * * * * * * * * * * * * * 16 ~ 31
// x x x * * * * * * * * * * * * * 32 ~ 47 (32 ~ 34)
// * * * x x x x x * * * * * * * * 48 ~ 63 (51 ~ 55)
// * * * * * * * * x x x x x * * * 64 ~ 79 (72 ~ 76)
// * * * * * * * * * * * * * x x x 80 ~ 95 (93 ~ 95)
// * * * * * * * * * * * * * * * * 96 ~ 111
// * * * * * * * * * * * * * * * * 112 ~ 127

// [2]
// * * * * * * * * * * * * * * * *  0 ~ 15
// x x * * * * * * * * * * * * * * 16 ~ 31 (16 ~ 17)
// * * x x x * * * * * * * * * * * 32 ~ 47 (34 ~ 36)
// * * * * * x x x * * * * * * * * 48 ~ 63 (53 ~ 55)
// * * * * * * * * x x x * * * * * 64 ~ 79 (72 ~ 74)
// * * * * * * * * * * * x x x * * 80 ~ 95 (91 ~ 93)
// * * * * * * * * * * * * * * x x 96 ~ 111 (110 ~ 111)
// * * * * * * * * * * * * * * * * 112 ~ 127

// [3]
// x x * * * * * * * * * * * * * *  0 ~ 15 (0 ~ 1)
// * * x x * * * * * * * * * * * * 16 ~ 31 (18 ~ 19)
// * * * * x x * * * * * * * * * * 32 ~ 47 (36 ~ 37)
// * * * * * * x x * * * * * * * * 48 ~ 63 (54 ~ 55)
// * * * * * * * * x x * * * * * * 64 ~ 79 (72 ~ 73)
// * * * * * * * * * * x x * * * * 80 ~ 95 (90 ~ 91)
// * * * * * * * * * * * * x x * * 96 ~ 111 (108 ~ 109)
// * * * * * * * * * * * * * * x x 112 ~ 127 (126 ~ 127)

// [4]
// * * x * * * * * * * * * * * * *  0 ~ 15 (2)
// * * * x x * * * * * * * * * * * 16 ~ 31 (19 ~ 20)
// * * * * * x * * * * * * * * * * 32 ~ 47 (37)
// * * * * * * x x * * * * * * * * 48 ~ 63 (54 ~ 55)
// * * * * * * * * x x * * * * * * 64 ~ 79 (72 ~ 73)
// * * * * * * * * * x x * * * * * 80 ~ 95 (89 ~ 90)
// * * * * * * * * * * * x x * * * 96 ~ 111 (107 ~ 108)
// * * * * * * * * * * * * * x * * 112 ~ 127 (125)

// [5]
// * * * * x * * * * * * * * * * *  0 ~ 15 (4)
// * * * * * x * * * * * * * * * * 16 ~ 31 (21)
// * * * * * * x * * * * * * * * * 32 ~ 47 (38)
// * * * * * * * x * * * * * * * * 48 ~ 63 (55)
// * * * * * * * * x * * * * * * * 64 ~ 79 (72)
// * * * * * * * * * x * * * * * * 80 ~ 95 (89)
// * * * * * * * * * * x * * * * * 96 ~ 111 (106)
// * * * * * * * * * * * x * * * * 112 ~ 127 (123)

// [6]
// * * * * * * x * * * * * * * * *  0 ~ 15 (6)
// * * * * * * x * * * * * * * * * 16 ~ 31 (22)
// * * * * * * * x * * * * * * * * 32 ~ 47 (39)
// * * * * * * * x * * * * * * * * 48 ~ 63 (55)
// * * * * * * * * x * * * * * * * 64 ~ 79 (72)
// * * * * * * * * x * * * * * * * 80 ~ 95 (88)
// * * * * * * * * * x * * * * * * 96 ~ 111 (105)
// * * * * * * * * * x * * * * * * 112 ~ 127 (121)

// [7]
// * * * * * * * x * * * * * * * *  0 ~ 15 (7)
// * * * * * * * x * * * * * * * * 16 ~ 31 (23)
// * * * * * * * x * * * * * * * * 32 ~ 47 (39)
// * * * * * * * x * * * * * * * * 48 ~ 63 (55)
// * * * * * * * * x * * * * * * * 64 ~ 79 (72)
// * * * * * * * * x * * * * * * * 80 ~ 95 (88)
// * * * * * * * * x * * * * * * * 96 ~ 111 (104)
// * * * * * * * * x * * * * * * * 112 ~ 127 (120)

// [8]
// * * * * * * * * * x * * * * * *  0 ~ 15 (9)
// * * * * * * * * * x * * * * * * 16 ~ 31 (25)
// * * * * * * * * x * * * * * * * 32 ~ 47 (40)
// * * * * * * * * x * * * * * * * 48 ~ 63 (56)
// * * * * * * * x * * * * * * * * 64 ~ 79 (71)
// * * * * * * * x * * * * * * * * 80 ~ 95 (87)
// * * * * * * x * * * * * * * * * 96 ~ 111 (102)
// * * * * * * x * * * * * * * * * 112 ~ 127 (118)

// [9]
// * * * * * * * * * * * x * * * *  0 ~ 15 (11)
// * * * * * * * * * * x * * * * * 16 ~ 31 (25)
// * * * * * * * * * x * * * * * * 32 ~ 47 (41)
// * * * * * * * * x * * * * * * * 48 ~ 63 (56)
// * * * * * * * x * * * * * * * * 64 ~ 79 (71)
// * * * * * * x * * * * * * * * * 80 ~ 95 (86)
// * * * * * x * * * * * * * * * * 96 ~ 111 (101)
// * * * * x * * * * * * * * * * * 112 ~ 127 (116)

// [10]
// * * * * * * * * * * * * * x * *  0 ~ 15
// * * * * * * * * * * * x x * * * 16 ~ 31
// * * * * * * * * * * x * * * * * 32 ~ 47
// * * * * * * * * x x * * * * * * 48 ~ 63 (48 ~ 55)
// * * * * * * x x * * * * * * * * 64 ~ 79 (72 ~ 79)
// * * * * * x x * * * * * * * * * 80 ~ 95
// * * * x x * * * * * * * * * * * 96 ~ 111
// * * x * * * * * * * * * * * * * 112 ~ 127

// [11]
// * * * * * * * * * * * * * * x x  0 ~ 15 (14 ~ 15)
// * * * * * * * * * * * * x x * * 16 ~ 31 (28 ~ 29)
// * * * * * * * * * * x x * * * * 32 ~ 47 (42 ~ 43)
// * * * * * * * * x x * * * * * * 48 ~ 63 (56 ~ 57)
// * * * * * * x x * * * * * * * * 64 ~ 79 (70 ~ 71)
// * * * * x x * * * * * * * * * * 80 ~ 95 (84 ~ 85)
// * * x x * * * * * * * * * * * * 96 ~ 111 (98 ~ 99)
// x x * * * * * * * * * * * * * * 112 ~ 127 (112 ~ 113)

// [12]
// * * * * * * * * * * * * * * * *  0 ~ 15 (14 ~ 15)
// * * * * * * * * * * * * * * x x 16 ~ 31 (30 ~ 31)
// * * * * * * * * * * * x x x * * 32 ~ 47 (43 ~ 45)
// * * * * * * * * x x x * * * * * 48 ~ 63 (56 ~ 58)
// * * * * * x x x * * * * * * * * 64 ~ 79 (69 ~ 71)
// * * x x x * * * * * * * * * * * 80 ~ 95 (82 ~ 84)
// x x * * * * * * * * * * * * * * 96 ~ 111 (96 ~ 97)
// * * * * * * * * * * * * * * * * 112 ~ 127

// [13]
// * * * * * * * * * * * * * * * *  0 ~ 15
// * * * * * * * * * * * * * * * * 16 ~ 31
// * * * * * * * * * * * * * x x x 32 ~ 47 (45 ~ 47)
// * * * * * * * * x x x x x * * * 48 ~ 63 (56 ~ 60)
// * * * x x x x x * * * * * * * * 64 ~ 79 (67 ~ 71)
// x x x * * * * * * * * * * * * * 80 ~ 95 (80 ~ 82)
// * * * * * * * * * * * * * * * * 96 ~ 111
// * * * * * * * * * * * * * * * * 112 ~ 127

// [14]
// * * * * * * * * * * * * * * * *  0 ~ 15
// * * * * * * * * * * * * * * * * 16 ~ 31
// * * * * * * * * * * * * * * * * 32 ~ 47
// * * * * * * * * x x x x x x x x 48 ~ 63 (56 ~ 63)
// x x x x x x x x * * * * * * * * 64 ~ 79 (64 ~ 71)
// * * * * * * * * * * * * * * * * 80 ~ 95
// * * * * * * * * * * * * * * * * 96 ~ 111
// * * * * * * * * * * * * * * * * 112 ~ 127